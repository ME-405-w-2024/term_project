<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>term_project: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">term_project
   </div>
   <div id="projectbrief">Auto aiming nerf gun term project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Overview </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_media_2mainpage"></a> </p>
<h1><a class="anchor" id="autotoc_md1"></a>
Description of code</h1>
<p>The code is broken up into three main portions, the main control loop, the camera processing functions, and the remote stepper driver.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Main Control Loop</h2>
<p>The main control loop is contained in <a class="el" href="main_8py.html" title="This file lays out the main functionality of the shooting mechanism.">main.py</a>. It initalizes all neccesary objects and local variables in order to run all of the functions of the launcher.</p>
<p>This includes:</p>
<ul>
<li>Camera Driver</li>
<li>Servo Driver</li>
<li>Stepper Driver Communication</li>
<li>Button Polling</li>
<li>State Control</li>
</ul>
<p>as the main functions.</p>
<p>As for the sequence of events controlled by the main loop, the operation is given below. This is also reflected in the state diagram.</p>
<ol type="1">
<li>Wait for button to be pressed.</li>
<li>Begin continuous targeting using the camera data, which is used to yield a target angle.</li>
<li>After 4 seconds of continuous targeting, the flywheels are spun up.</li>
<li>After 1 second of spinup, the targeted position is held for 1 more second.</li>
<li>After this time, the ball-indexing servo is moved to fire the ball.</li>
<li>Another 1 second delay is given to allow the flywheels time to slow down.</li>
<li>The turret returns to its home position and waits for another button press.</li>
</ol>
<p>No tasks were used, as all time-sensitive functions were either handled by timer interrupts (in the cases where PWM was needed), or were handled on separate controllers (in the case of the stepper driver)</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Remote Stepper Driver</h2>
<p>The aiming platform is a turret-based system that is rotated by a belt-driven stepper motor.</p>
<p>To achieve full control over the stepper motor's motion profile, a separate microcontroller is used as a dedicated step planner and generator. The controller used was an arduino nano with firmware written in both standard C++ as well as Arduino's version of C in order to leverage the ease of use from the arduino ecosystem.</p>
<p>This system relies heavily on accurate timing and low calculation overhead in order to achieve maximum step speed and accuracy. Additionally, motion planning was important in order to utilize the maximum speed of the stepper motor without losing steps. To accomplish these goals, a version of the <a href="https://cdck-file-uploads-europe1.s3.dualstack.eu-west-1.amazonaws.com/arduino/original/3X/f/7/f7861c732d17db124bdc320398a31bc2023ce996.pdf">stepper control algorithm as laid out by D. Austin</a> was implemented. The only notable change made to the math was a conversion to units of RPM from rad/sec. More information on using individual functions can be found in <a class="el" href="class_stepper_driver.html">StepperDriver</a>.</p>
<p>The remote board (containing its own stepper driving hardware, the arduino, and power conversion) was communicated with via I2C, and given information of requested position, motor speed and motor accelerations. All other calculation was handled by the microcontroller on the arduino, freeing up significant time on the STM32.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
State Diagram</h1>
<p><img src="https://github.com/ME-405-w-2024/term_project/blob/main/media/StateDiagram.png" alt="State Diagram" class="inline"/> </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
